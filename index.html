
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Shotcrete Calc — Calculadora</title>

  <style>
    :root { color-scheme: light dark; }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    header { padding: .8rem 1rem; background: #0a84ff; color: #fff; }
    main { padding: 1rem; max-width: 900px; margin: 0 auto; }
    fieldset { border: 1px solid #ddd; padding: 1rem; border-radius: .5rem; margin-bottom: 1rem; }
    legend { font-weight: 600; }
    label { display: block; margin: .5rem 0 .25rem; }
    input { width: 100%; padding: .5rem; font-size: 1rem; }
    .row3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; }
    .row2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    .actions { display: flex; flex-wrap: wrap; gap: .5rem; margin-top: .75rem; }
    button { padding: .6rem 1rem; font-size: 1rem; border: none; border-radius: .4rem; cursor: pointer; }
    .primary { background: #0a84ff; color: #fff; }
    .secondary { background: #555; color: #fff; }
    .result { margin-top: 1rem; padding: .75rem; background: #f6f8fa; border-radius: .5rem; white-space: pre-line; }
    .muted { color: #666; font-size: .9rem; }
    @media (prefers-color-scheme: dark) {
      fieldset { border-color: #333; }
      .result { background: #151515; }
    }
  </style>
</head>
<body>
  <header>
    <h1 style="margin:0">Shotcrete Calc — Calculadora</h1>
  </header>

  <main>
    <!-- ====== CALCULADORA ====== -->
    <section id="tab-calc" class="active">
      <fieldset>
        <legend>Calculadora de cubicación (A, H, L + frente de sacrificio)</legend>

        <div class="row3">
          <div>
            <label for="ancho">Ancho (A) — m</label>
            <input id="ancho" type="number" step="0.01" min="0" placeholder="Ej. 4.00">
          </div>
          <div>
            <label for="altura">Altura (H) — m</label>
            <input id="altura" type="number" step="0.01" min="0" placeholder="Ej. 3.50">
          </div>
          <div>
            <label for="largo">Largo (L) — m</label>
            <input id="largo" type="number" step="0.01" min="0" placeholder="Ej. 20.00">
          </div>
        </div>

        <div class="row2" style="margin-top:1rem">
          <div>
            <label for="sacrificio">Frente de sacrificio — m³</label>
            <input id="sacrificio" type="number" step="0.01" min="0" placeholder="Ej. 0.50">
            <div class="muted">Se suma al volumen calculado por la fórmula.</div>
          </div>
          <div>
            <label for="const_115">Constante de conversión (m²/m³)</label>
            <input id="const_115" type="number" step="0.01" min="0" value="11.5">
            <div class="muted">Por defecto 11.5 (11.5 m² se lanzan con 1 m³).</div>
          </div>
        </div>

        <div class="actions">
          <button class="primary" id="btn-calcular-m3">Calcular m³</button>
          <button class="secondary" id="btn-limpiar-m3">Limpiar</button>
        </div>

        <div id="calc-resultado" class="result" aria-live="polite">
          Ingresa A, H, L y el frente de sacrificio, luego presiona <strong>Calcular m³</strong>.
        </div>
      </fieldset>
    </section>
  </main>

  <!-- ====== JAVASCRIPT ====== -->
  <script>
    // Formateador a 3 decimales
    const fmt3 = (n) => Number(n).toFixed(3);

    // Cálculo: ((((H*2)+A)*0.9)*L)/11.5  y suma frente de sacrificio
    function calcularM3() {
      const A = parseFloat(document.getElementById('ancho').value || '0');
      const H = parseFloat(document.getElementById('altura').value || '0');
      const L = parseFloat(document.getElementById('largo').value || '0');
      const sacrificio = parseFloat(document.getElementById('sacrificio').value || '0');
      const c115 = parseFloat(document.getElementById('const_115').value || '11.5');

      // Validaciones básicas
      if (!isFinite(A) || !isFinite(H) || !isFinite(L) || !isFinite(sacrificio) || !isFinite(c115)) {
        document.getElementById('calc-resultado').textContent =
          'Revisa los valores ingresados: deben ser números válidos.';
        return;
      }
      if (c115 <= 0) {
        document.getElementById('calc-resultado').textContent =
          'La constante de conversión debe ser mayor que 0.';
        return;
      }

      // Desglose de la fórmula
      const perimetroParcial = (H * 2) + A;          // m
      const perimetroAjustado = perimetroParcial * 0.9; // m (factor 0.9)
      const areaLineal = perimetroAjustado * L;      // m²
      const m3_base = areaLineal / c115;             // m³
      const m3_total = m3_base + sacrificio;         // m³

      const texto =
`Datos:
A (ancho) = ${fmt3(A)} m
H (altura) = ${fmt3(H)} m
L (largo) = ${fmt3(L)} m
Frente de sacrificio = ${fmt3(sacrificio)} m³
Constante = ${fmt3(c115)} m²/m³

Cálculo:
Perímetro parcial = (H*2)+A = (${fmt3(H)}*2)+${fmt3(A)} = ${fmt3(perimetroParcial)} m
Ajuste 0.9 = ${fmt3(perimetroParcial)} × 0.9 = ${fmt3(perimetroAjustado)} m
Área lineal = ${fmt3(perimetroAjustado)} × ${fmt3(L)} = ${fmt3(areaLineal)} m²
m³ base = Área lineal / ${fmt3(c115)} = ${fmt3(m3_base)} m³
--------------------------------
m³ TOTAL = m³ base + sacrificio = ${fmt3(m3_base)} + ${fmt3(sacrificio)} = ${fmt3(m3_total)} m³`;

      document.getElementById('calc-resultado').textContent = texto;

      // Retornar por si luego lo quieres guardar en Registro
      return {A, H, L, sacrificio, c115, m3_base, m3_total};
    }

    // Eventos
    document.getElementById('btn-calcular-m3').addEventListener('click', calcularM3);
    document.getElementById('btn-limpiar-m3').addEventListener('click', () => {
      ['ancho','altura','largo','sacrificio'].forEach(id => document.getElementById(id).value = '');
      document.getElementById('const_115').value = '11.5';
      document.getElementById('calc-resultado').textContent =
        'Ingresa A, H, L y el frente de sacrificio, luego presiona Calcular m³.';
    });
  </script>
</body>
</html>


