
<script>
  // --- Utilidad: eliminar nodos de texto específicos dentro de un contenedor ---
  function removeAccidentalText(container, exactText) {
    if (!container) return;
    // Recorremos hijos directos (y netos) para eliminar textos accidentales
    const walker = document.createTreeWalker(container, NodeFilter.SHOW_TEXT, null);
    const toRemove = [];
    while (walker.nextNode()) {
      const node = walker.currentNode;
      if (node.nodeValue && node.nodeValue.trim() === exactText) {
        toRemove.push(node);
      }
    }
    toRemove.forEach(n => n.parentNode && n.parentNode.removeChild(n));
  }

  // --- Limpiar la pestaña INGRESO/Calcular ---
  function limpiarIngreso() {
    // Campos que se deben vaciar
    const camposVacios = [
      'fecha','labor','nivel','ancho','largo','altura','guardia','observaciones','presion_bar'
    ];
    camposVacios.forEach(id => {
      const el = document.getElementById(id);
      if (el) el.value = '';
    });

    // Campos con valor por defecto
    const factor = document.getElementById('factor');
    const frente = document.getElementById('frente');
    if (factor) factor.value = '11.5';
    if (frente) frente.value = '0';

    // Select USO por defecto
    const uso = document.getElementById('uso');
    if (uso) uso.value = 'REP';

    // Ocultar panel de resultado y mensajes
    const panel = document.getElementById('panel-resultado');
    const msg   = document.getElementById('msg');
    if (panel) panel.style.display = 'none';
    if (msg)   msg.textContent = '';

    // Limpiar almacenamiento del formulario
    localStorage.removeItem('sc_form');

    // Eliminar cualquier texto accidental dentro de la pestaña Ingreso
    const tabIngreso = document.getElementById('tab-ingreso');
    removeAccidentalText(tabIngreso, 'Para revisión de reportes ROBOCON shotcrete 1.xlsx');
  }

  // --- Conecta el botón Limpiar (garantizado tras DOM listo) ---
  window.addEventListener('DOMContentLoaded', () => {
    const btnLimpiar = document.getElementById('btn-limpiar');
    if (btnLimpiar) {
      btnLimpiar.addEventListener('click', limpiarIngreso);
    }

    // También hacemos una limpieza de textos sueltos al cargar (por si venías con caché)
    const tabIngreso = document.getElementById('tab-ingreso');
    removeAccidentalText(tabIngreso, 'Para revisión de reportes ROBOCON shotcrete 1.xlsx');
  });
</script>

